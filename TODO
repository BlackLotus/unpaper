 * Options parsing should be re-done with more standard methods, but
   that would require changing the parameters' syntax breaking the
   command's consumers.
 * Allocations need to be verified to not overflow, as they are almost
   always generated by multiplication.
 * Code should be split into logical units preserving optimisations.
